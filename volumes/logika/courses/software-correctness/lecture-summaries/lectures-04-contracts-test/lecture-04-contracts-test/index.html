<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Slang Functions Example A: Pure Maximum Function 1 2 3 4 5 6 7 def max(x: Z, y: Z): Z = { if (x &amp;lt; y) { return y } else { return x } } Functions consist of a signature def max(x: Z, y: Z): Z and a body { ... }. The signature specifies the number of parameters, their type and the return type. The body contains the implementation code." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://doc.sireum.org/volumes/logika/courses/software-correctness/lecture-summaries/lectures-04-contracts-test/lecture-04-contracts-test/" />


    <title>
        
            Lecture Summary: Contracts Test :: Sireum Doc 
        
    </title>



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.14/themes/default/style.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.14/themes/default-dark/style.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://doc.sireum.org/_pagefind/pagefind-ui.css">




<link rel="stylesheet" href="https://doc.sireum.org/main.9b7fec326fab4b320f3a6ebff5b2cd1a56f40af9971ff15a0213c97eff1ce5d0.css" integrity="sha256-m3/sMm&#43;rSzIPOm6/9bLNGlb0CvmXH/FaAhPJfv8c5dA=">



    <link rel="apple-touch-icon" sizes="180x180" href="https://doc.sireum.org/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://doc.sireum.org/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://doc.sireum.org/favicon-16x16.png">
    <link rel="manifest" href="https://doc.sireum.org/site.webmanifest">
    <link rel="mask-icon" href="https://doc.sireum.org/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://doc.sireum.org/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Lecture Summary: Contracts Test">
<meta itemprop="description" content="Slang Functions Example A: Pure Maximum Function 1 2 3 4 5 6 7 def max(x: Z, y: Z): Z = { if (x &lt; y) { return y } else { return x } } Functions consist of a signature def max(x: Z, y: Z): Z and a body { ... }. The signature specifies the number of parameters, their type and the return type. The body contains the implementation code."><meta itemprop="datePublished" content="2022-11-24T17:01:09+01:00" />
<meta itemprop="dateModified" content="2022-11-24T17:01:09+01:00" />
<meta itemprop="wordCount" content="4531"><meta itemprop="image" content="https://doc.sireum.org"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://doc.sireum.org"/>

<meta name="twitter:title" content="Lecture Summary: Contracts Test"/>
<meta name="twitter:description" content="Slang Functions Example A: Pure Maximum Function 1 2 3 4 5 6 7 def max(x: Z, y: Z): Z = { if (x &lt; y) { return y } else { return x } } Functions consist of a signature def max(x: Z, y: Z): Z and a body { ... }. The signature specifies the number of parameters, their type and the return type. The body contains the implementation code."/>







    <meta property="article:published_time" content="2022-11-24 17:01:09 &#43;0100 &#43;0100" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="menu-trigger">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
        </svg>
    </span>
    <span class="header__inner">
        <a href="https://doc.sireum.org/" style="text-decoration: none;">
    <div class="logo">
        
            <img class="color-scheme" src="https://doc.sireum.org/img/santos/icon-doc.png" alt="">
            &nbsp;<span class="logo__text">Doc</span>
        
    </div>
</a>


        <span class="header__right">
            
                

<nav class="menu">
  <ul class="menu__inner">
  
  
    
      <div class="submenu">
        <li class="dropdown" onmouseover="menuDisplay(this.children[1], true);" onmouseout="menuDisplay(this.children[1], false);">
          <a class="dropbtn" href="https://doc.sireum.org/volumes/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Volumes&nbsp;<small>ᐁ</small></span>
            <span class="responsive-title-short">Volumes&nbsp;<small>ᐁ</small></span>
          </a>
          <div class="dropdown-content" align="left">
            <ul style="margin:8px;">
              
                
  
  
    
      <div>
        <li>
          <a href="https://doc.sireum.org/volumes/slang/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Slang</span>
            <span class="responsive-title-short">Slang</span>
          </a>
        </li>
      </div>
    
  

              
                
  
  
    
      <div>
        <li>
          <a href="https://doc.sireum.org/volumes/hamr/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">HAMR</span>
            <span class="responsive-title-short">HAMR</span>
          </a>
        </li>
      </div>
    
  

              
                
  
  
    
      <div>
        <li>
          <a href="https://doc.sireum.org/volumes/logika" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Logika</span>
            <span class="responsive-title-short">Logika</span>
          </a>
        </li>
      </div>
    
  

              
            </ul>
          </div>
        </li>
      </div>
    
  

  
  
    
      <div class="submenu">
        <li class="dropdown" onmouseover="menuDisplay(this.children[1], true);" onmouseout="menuDisplay(this.children[1], false);">
          <a class="dropbtn" href="https://doc.sireum.org/venues/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Venues&nbsp;<small>ᐁ</small></span>
            <span class="responsive-title-short">Venues&nbsp;<small>ᐁ</small></span>
          </a>
          <div class="dropdown-content" align="left">
            <ul style="margin:8px;">
              
                
  
  
    
      <div>
        <li>
          <a href="https://doc.sireum.org/venues/tutorials/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Tutorials</span>
            <span class="responsive-title-short">Tutorials</span>
          </a>
        </li>
      </div>
    
  

              
                
  
  
    
      <div>
        <li>
          <a href="https://doc.sireum.org/venues/presentations/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Presentations</span>
            <span class="responsive-title-short">Presentations</span>
          </a>
        </li>
      </div>
    
  

              
            </ul>
          </div>
        </li>
      </div>
    
  

  
  
    
      <div>
        <li>
          <a href="https://sireum.org/getting-started/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Download</span>
            <span class="responsive-title-short">Download</span>
          </a>
        </li>
      </div>
    
  

  
  
    
      <div>
        <li>
          <a href="https://sireum.org/papers" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Papers</span>
            <span class="responsive-title-short">Papers</span>
          </a>
        </li>
      </div>
    
  

  
  
    
      <div>
        <li>
          <a href="https://sireum.org/funding" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Funding</span>
            <span class="responsive-title-short">Funding</span>
          </a>
        </li>
      </div>
    
  

  
  
    
      <div>
        <li>
          <a href="https://sireum.org/team" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">
            <span class="responsive-title-long">Team</span>
            <span class="responsive-title-short">Team</span>
          </a>
        </li>
      </div>
    
  

  </ul>
</nav>

            
        </span>
    </span>
        <span class="theme-toggle not-selectable" style="margin-right: 10px"><img src="https://doc.sireum.org/img/toggle.png" height="20px"></span>
      <div class="submenu">
          <li class="dropdown" onmouseover="menuDisplay(this.children[1], true); searchFocus();" onmouseout="menuDisplay(this.children[1], false);">
              <a class="dropbtn fa fa-search"></a>
              <div class="dropdown-content" align="left">
                  <div id="search" style="z-index:2147483647; position: fixed;"></div>
              </div>
          </li>
      </div>
    
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://doc.sireum.org/volumes/logika/courses/software-correctness/lecture-summaries/lectures-04-contracts-test/lecture-04-contracts-test/">Lecture Summary: Contracts Test</a></h2>

            
            
            
                <hr />
                <aside id="toc">
                <div class="toc-title">Table of Contents</div>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#slang-functions">Slang Functions</a>
      <ul>
        <li><a href="#example-a-pure-maximum-function">Example A: Pure Maximum Function</a></li>
        <li><a href="#example-a-pure-maximum-function-contract">Example A: Pure Maximum Function Contract</a></li>
        <li><a href="#example-b-impure-maximum-function">Example B: Impure Maximum Function</a></li>
        <li><a href="#example-b-impure-maximum-function-with-modifies-clause">Example B: Impure Maximum Function with Modifies Clause</a></li>
        <li><a href="#fame-of-a-function">Fame of a Function</a></li>
        <li><a href="#specification-and-implementation">Specification and Implementation</a></li>
        <li><a href="#exercise-1">Exercise 1</a></li>
      </ul>
    </li>
    <li><a href="#testing-with-contracts">Testing with Contracts</a>
      <ul>
        <li><a href="#example-c-testing-the-maximum-function">Example C: Testing the Maximum Function</a></li>
        <li><a href="#test-cases-from-specifications">Test Cases from Specifications</a></li>
        <li><a href="#equivalence-partitioning">Equivalence Partitioning</a></li>
        <li><a href="#boundary-value-analysis">Boundary Value Analysis</a></li>
        <li><a href="#test-case-formulation">Test Case Formulation</a></li>
        <li><a href="#test-cases-from-implementations">Test Cases from Implementations</a></li>
        <li><a href="#test-cases-from-implementations-using-boundary-values">Test Cases from Implementations (Using Boundary Values)</a></li>
      </ul>
    </li>
    <li><a href="#symbolic-execution">Symbolic Execution</a>
      <ul>
        <li><a href="#symbolic-execution-of-the-function-branch-1">Symbolic Execution of the Function Branch 1</a></li>
        <li><a href="#symbolic-execution-of-the-function-branch-2">Symbolic Execution of the Function Branch 2</a></li>
        <li><a href="#result-of-the-symbolic-execution">Result of the Symbolic Execution</a></li>
        <li><a href="#exercise-2">Exercise 2</a></li>
      </ul>
    </li>
    <li><a href="#testing-for-faults">Testing for Faults</a>
      <ul>
        <li><a href="#test-cases-for-faults-in-implementations">Test Cases for Faults in Implementations</a></li>
        <li><a href="#counterexamples-from-implementations">Counterexamples from Implementations</a></li>
        <li><a href="#test-cases-for-faults-in-implementations-1">Test Cases for Faults in Implementations</a></li>
        <li><a href="#exercise-3">Exercise 3</a></li>
      </ul>
    </li>
    <li><a href="#exercises">Exercises</a>
      <ul>
        <li><a href="#exercise-4">Exercise 4</a></li>
        <li><a href="#exercise-5-outlook">Exercise 5 (Outlook)</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </aside>
                <hr />
            

            <div class="post-content">
                <h3 id="slang-functions">Slang Functions</h3>
<h4 id="example-a-pure-maximum-function">Example A: Pure Maximum Function</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">def</span> <span class="n">max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Functions consist of a signature <code>def max(x: Z, y: Z): Z</code> and a body <code>{ ... }</code>.
The signature specifies the number of parameters, their type and the return type.
The body contains the implementation code.
Functions that do not return a value can also be defined <code>def fun(x: Z, y: Z) { ... }</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nd">@pure</span> <span class="k">def</span> <span class="n">pure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The body of function <code>max</code> only refers to the function parameters.
Such functions are called <strong>pure</strong>.
The <code>@pure</code> attribute indicates to Logika that the function is <strong>free of side-effects</strong>.
When a <strong>contract</strong> is added it can be used in deductions like any other mathematical operator, e.g., <code>+</code> or <code>&lt;</code>.
Let&rsquo;s have a look at contracts.</p>
<h4 id="example-a-pure-maximum-function-contract">Example A: Pure Maximum Function Contract</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nd">@pure</span> <span class="k">def</span> <span class="n">pure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Contracts specify what&rsquo;s <strong>required</strong> <em>before</em> the function is executed and what&rsquo;s <strong>ensured</strong> <em>after</em> the function has been executed.
Let&rsquo;s state this informally.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nd">@pure</span> <span class="k">def</span> <span class="n">pure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// contract
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   requires pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   ensures post-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>What&rsquo;s <strong>required</strong> is called the <strong>pre-condition</strong> of the function.
What&rsquo;s <strong>ensured</strong> is called the <strong>post-condition</strong> of the function.
We have already sketched such contracts using <code>assume-assert</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nd">@pure</span> <span class="k">def</span> <span class="n">pure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// contract
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   requires x &gt; 0, y &gt; 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   ensures Res == x | Res == y, x &lt;= Res, y &lt;= Res
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It looked similar to this, reading <code>,</code> in the contract clauses as conjunctions.
What&rsquo;s new is the reference to <code>Res</code> in the <code>ensures</code> clause.
The special variable <em>Res</em> is needed to deal with <code>return</code> statement.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nd">@pure</span> <span class="k">def</span> <span class="n">pure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// contract
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   requires x &gt; 0, y &gt; 0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   ensures Res == x | Res == y, x &lt;= Res, y &lt;= Res
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span>  <span class="c1">// Res = y
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>  <span class="c1">// Res = x
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can read <code>return</code> statements as assignments to <code>Res</code> as indicated in the comments.
This makes it straightforward to relate the post-condition to the function body.
In Slang syntax it looks as follows &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nd">@pure</span> <span class="k">def</span> <span class="n">pure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Remember to read <code>return</code> statements as assignments to <code>Res</code>.
Pure function <code>pure_max</code> with its contract can now be used in formulas.
In some context we could write, e.g., <code>Deduce(|- (z == max(x, y)))</code>.</p>
<h4 id="example-b-impure-maximum-function">Example B: Impure Maximum Function</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">z</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">impure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Function <code>impure_max</code> modified variable <code>z</code> outside its scope.
It has the side-effect of modifying variable <code>z</code>.
As opposed to function <code>pure_max</code> this function is <strong>impure</strong>.
Logika rejects the program above.
<img src="../images/Missing_Modifies_Clause.png" alt="Missing_Modifies_Clause"></p>
<h4 id="example-b-impure-maximum-function-with-modifies-clause">Example B: Impure Maximum Function with Modifies Clause</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">z</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">impure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// contract
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   modifies frame
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>For impure functions the variables they modify outside their scope must be listed in the contract
This is done by means of the <code>modifies</code> clause that specifies a function&rsquo;s <strong>frame</strong>.
A frame is a (comma-separated) list of variables.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">z</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">impure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// contract
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   modifies z
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The frame of function <code>impure_max</code> is just the single variable <code>z</code>.
We will discuss this more next week.
For now we note that for a function with side-effects it is important to know which variables it might modify.</p>
<h4 id="fame-of-a-function">Fame of a Function</h4>
<p>Consider a function with a contract.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">m</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="k">var</span> <span class="n">n</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">equalize</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// contract
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">//   ensures m == n
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This could be achieved by assigning <code>m</code> to <code>n</code>, or <code>n</code> to <code>m</code>, or a common value to both.
In general, the result of a function could be obtained by modifying variables that were intended as parameters.
The <code>modifies</code> clause permits us to describe which variables might change and which do not.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">z</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">impure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Modifies</span><span class="o">(</span><span class="n">z</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In the function above the frame is specified in the Slang contract notation.
With the <code>Modifies</code> clause added Logika accepts the function.
<img src="../images/Inserted_Modifies_clause.png" alt="Inserted_Modifies_clause"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">z</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">impure_max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Modifies</span><span class="o">(</span><span class="n">z</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="n">z</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="n">z</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now we can specify the complete contract for the function.
Note the use of variable <code>z</code> in place of <code>Res</code> in the pure version of the function.</p>
<h4 id="specification-and-implementation">Specification and Implementation</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">val</span> <span class="n">x</span> <span class="k">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="n">assume</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="n">y</span> <span class="k">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="n">assume</span><span class="o">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">impure_max</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nc">Deduce</span><span class="o">(|-</span> <span class="o">(</span><span class="n">z</span> <span class="o">==</span> <span class="n">pure_max</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can now program with the impure function and use the pure function in correctness proofs.
(Of course, we can also program with the pure function)
Pure functions are often clearer but less efficient. They are good specifications.
Impure functions are often more efficient but less clear. They are good implementations.</p>
<p>The fragment above proves that <code>impure_max</code> implements <code>pure_max</code> related by <code>z == pure_max(x, y)</code>.
We also say that <code>impure_max</code> refines <code>pure_max</code>.
Note, the use of <code>assume</code> to constrain the values of <code>x</code> and <code>y</code>.
<code>assume</code> is most useful to support proofs of the kind above.</p>
<h4 id="exercise-1">Exercise 1</h4>
<p>Add contracts to functions <code>max</code> and <code>pure_max</code> so that the deduction at the end is verified.
<img src="../images/Exercise1.png" alt="Exercise1"></p>
<h3 id="testing-with-contracts">Testing with Contracts</h3>
<h4 id="example-c-testing-the-maximum-function">Example C: Testing the Maximum Function</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">def</span> <span class="n">max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span> <span class="c1">// &#34;Res = y&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span> <span class="c1">// &#34;Res = x&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Suppose the body of function <code>max</code> was more complex and we would have no proof that the body establishes the post-condition.
We would like to have a method that helps us systematically to come up with test cases.</p>
<h4 id="test-cases-from-specifications">Test Cases from Specifications</h4>
<div class="highlight" linenps="newLine"><pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">def</span> <span class="n">max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>We only consider the contract that specifies the behaviour of the function.
The pre-condition restricts the values to be considered for the <strong>defined</strong> behaviour of the function.
The post-condition describes possible outcomes depending on the input values:</p>
<ul>
<li>If <code>Res == x</code> then <code>y &lt;= x</code></li>
<li>If <code>Res == y</code> then <code>x &lt;= y</code></li>
</ul>
<h4 id="equivalence-partitioning">Equivalence Partitioning</h4>
<p>We can analyse the different in which <code>y &lt;= x</code> and <code>x &lt;= y</code> and their negations are conjoined to predict conditions occurring in an implementation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"> <span class="o">(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="o">)</span> <span class="o">&amp;</span>  <span class="o">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="o">)</span> <span class="k">if</span> <span class="n">and</span> <span class="n">only</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"> <span class="o">(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">!(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="o">)</span> <span class="k">if</span> <span class="n">and</span> <span class="n">only</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="o">!(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="o">)</span> <span class="o">&amp;</span>  <span class="o">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="o">)</span> <span class="k">if</span> <span class="n">and</span> <span class="n">only</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="o">!(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="o">)</span> <span class="o">&amp;</span> <span class="o">!(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="o">)</span> <span class="k">if</span> <span class="n">and</span> <span class="n">only</span> <span class="k">if</span> <span class="kc">false</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We get three cases to consider: <code>x &lt; y</code>, <code>x == y</code>, <code>x &gt; y</code>.
These are called equivalence classes.</p>
<h4 id="boundary-value-analysis">Boundary Value Analysis</h4>
<p>We can analyse pre-condition <code>x &gt; 0</code> and <code>y &gt; 0</code>.
They bound the possible values the parameters may take.
The smallest value for <code>x</code> and <code>y</code> is <code>1</code>.
<code>1</code> is a <strong>boundary value</strong> for <code>x</code> and <code>y</code>.
<em>Aside</em>. In some cases it is interesting to test the behaviour of a function when the pre-condition is violated, e.g., when security is a concern.
We have collected equivalence classes and boundary values.
These can be used to formulate test cases.</p>
<h4 id="test-case-formulation">Test Case Formulation</h4>
<p>Combining equivalence classes with boundary values we can calculate expected results.</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>Input x</th>
<th>Input y</th>
<th>Output Res</th>
</tr>
</thead>
<tbody>
<tr>
<td>x &lt; y</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>x == y</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>x &gt; y</td>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>The output <code>Res</code> must satisfy the condition <code>Res == x | Res == y &amp; x &lt;= Res &amp; y &lt;= Res</code>.
Inserting the values for <code>x</code> and <code>y</code> from the table,<code>Res</code> can be calculated.
Boundary values have been shown to be good choices for detecting faults in programs.
The derivation of the test cases above is driven by heuristics of equivalence partitioning and boundary value analysis.</p>
<ul>
<li>The test cases are <strong>not</strong> best choices but <em>heuristically well chosen</em></li>
<li>The test cases might miss important faults in a program</li>
</ul>
<h4 id="test-cases-from-implementations">Test Cases from Implementations</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">def</span> <span class="n">max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span> <span class="c1">// &#34;Res = y&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span> <span class="c1">// &#34;Res = x&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Taking the body of function <code>max</code> we can make sure that all statements and conditions on all branches are tested.
&ldquo;all statements and conditions on all branches&rdquo; is called a <strong>coverage criterion</strong>.
<em>Aside</em>. Other coverage criteria exist (but we will not discuss them).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">def</span> <span class="n">max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span> <span class="c1">// &#34;Res = y&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span> <span class="c1">// &#34;Res = x&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s have a look at the fact corresponding to the program.
The body has two branches that are followed depending on whether the condition <code>x &lt; y</code> is <code>true</code> or <code>false</code>.</p>
<p>We derive test cases from the fact
<code>pre-condition &amp;</code>
<strong>body<sub>fact</sub> &amp;</strong> (replacing &lsquo;<code>return e</code>&rsquo; by &lsquo;<code>Res = e</code>&rsquo; in body)
<code>post-condition</code>
For function <code>max</code> we get:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="k">=&gt;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">!(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;</span>                       <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Conjoining either <code>x &lt; y</code> or <code>x &gt;= y</code> we force the choice between branch 1 and branch 2.</p>
<p>Two facts result, one for each branch.</p>
<p>Branch 1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span> <span class="o">&amp;</span>                           <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Our prior analysis of the specification suggested that it would be good to split <code>x &gt;= y</code> into the cases <code>x == y</code> and <code>x &gt; y</code> to be tested separately.</p>
<p>Branch 1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span> <span class="o">&amp;</span>                           <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x == y</code>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x &gt; y</code>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="test-cases-from-implementations-using-boundary-values">Test Cases from Implementations (Using Boundary Values)</h4>
<p>Branch 1: <code>x == 1</code>, <code>y == 2</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span> <span class="o">&amp;</span>                           <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x == y</code>): <code>x == 1</code>, <code>y == 1</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x &gt; y</code>): <code>x == 2</code>, <code>y == 1</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 1: <code>x == 1</code>, <code>y == 2</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span>                           <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x == y</code>): <code>x == 1</code>, <code>y == 1</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x &gt; y</code>): <code>x == 2</code>, <code>y == 1</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">2</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 1: <code>x == 1</code>, <code>y == 2</code>, <code>Res == 2</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span>                           <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x == y</code>): <code>x == 1</code>, <code>y == 1</code>, <code>Res == 1</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x &gt; y</code>): <code>x == 2</code>, <code>y == 1</code>, <code>Res == 2</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">2</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span>                          <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="nc">Res</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="nc">Res</span>  <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 1: <code>x == 1</code>, <code>y == 2</code>, <code>Res == 2</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span>                             <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">2</span>          <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x == y</code>): <code>x == 1</code>, <code>y == 1</code>, <code>Res == 1</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;</span>                            <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">1</span>          <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 2 (with <code>x &gt; y</code>): <code>x == 2</code>, <code>y == 1</code>, <code>Res == 2</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;</span>                              <span class="c1">// Pre-condition
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="mi">2</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span>                            <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">|</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="mi">2</span>          <span class="c1">// Post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Branch 1</p>
<ul>
<li><em>satisfied by test case</em></li>
<li><em>input:</em> <code>x == 1, y == 2</code></li>
<li><em>output:</em> <code>Res == 2</code></li>
</ul>
<p>Branch 2</p>
<ul>
<li><em>with</em> <code>x == y</code> <em>satisfied by test case</em></li>
<li><em>input:</em> <code>x == 1, y == 1</code></li>
<li><em>output:</em> <code>Ress == 1</code></li>
</ul>
<p>Branch 2</p>
<ul>
<li><em>with</em> <code>x &gt; y</code> <em>satisfied by test case</em></li>
<li><em>input:</em> <code>x == 2, y == 1</code></li>
<li><em>output:</em> <code>Res == 2</code></li>
</ul>
<h3 id="symbolic-execution">Symbolic Execution</h3>
<h4 id="symbolic-execution-of-the-function-branch-1">Symbolic Execution of the Function Branch 1</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="o">...</span> <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span> <span class="nc">Ensures</span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">y</span> <span class="c1">// &#34;Res = y&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">x</span> <span class="c1">// &#34;Res = x&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Entering the function yields (<code>x: X, y: Y, Res: RES</code>), (PC: <code>X &gt; 0, Y &gt; 0</code>)</li>
<li>Executing <code>if (x &lt; y) {</code> yields (<code>x: X, x: X, Res: RES</code>), (PC: <code>X &gt; 0, Y &gt; 0, X &lt; Y</code>)</li>
<li>Executing <code>return y // &quot;Res = y&quot;</code> yields (<code>x: X, y: Y, Res: Y</code>), (PC: <code>X &gt; 0, Y &gt; 0, X &lt; Y</code>)</li>
<li>Leaving the function yields (<code>x: X, y: Y, Res: Y</code>), (PC: <code>X &gt; 0, Y &gt; 0, X &lt; Y, Y == X | Y == Y, X &lt;= Y, Y &lt;= X</code>)</li>
</ul>
<h4 id="symbolic-execution-of-the-function-branch-2">Symbolic Execution of the Function Branch 2</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="o">...</span> <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span> <span class="nc">Ensures</span><span class="o">(</span><span class="nc">Res</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="nc">Res</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="nc">Res</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">y</span> <span class="c1">// &#34;Res = y&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">x</span> <span class="c1">// &#34;Res = x&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Entering the function yields (<code>x: X, y: Y, Res: RES</code>), (PC: <code>X &gt; 0, Y &gt; 0</code>)</li>
<li>Executing <code>} else {</code> yields (<code>x: X, x: X, Res: RES</code>), (PC: <code>X &gt; 0, Y &gt; 0, X &gt;= Y</code>)</li>
<li>Executing <code>return x // &quot;Res = x&quot;</code> yields (<code>x: X, y: Y, Res: X</code>), (PC: <code>X &gt; 0, Y &gt; 0, X &gt;= Y</code>)</li>
<li>Leaving the function yields (<code>x: X, y: Y, Res: X</code>), (PC: <code>X &gt; 0, Y &gt; 0, X &gt;= Y, X == X | X == Y, X &lt;= X, Y &lt;= X</code>)</li>
</ul>
<h4 id="result-of-the-symbolic-execution">Result of the Symbolic Execution</h4>
<p>Symbolic execution of function <code>max</code> produces the following two results.</p>
<ul>
<li>(<code>x: X, y: Y, Res: Y</code>), (PC: <code>X &gt; 0, Y &gt; 0, X &lt; Y, Y == X | Y == Y, X &lt;= Y, Y &lt;= Y</code>)</li>
<li>(<code>x: X, y: Y, Res: X</code>), (PC: <code>X &gt; 0, Y &gt; 0, X &gt;= Y, X == X | X == Y, X &lt;= X, Y &lt;= X</code>)</li>
</ul>
<p>We can state these as facts:</p>
<ul>
<li><code>x == X, y == Y, Res == Y, X &gt; 0 &amp; Y &gt; 0 &amp; X &lt; Y &amp; (Y == X | Y == Y) &amp; X &lt;= Y &amp; Y &lt;= Y</code></li>
<li><code>x == X, y == Y, Res == X, X &gt; 0 &amp; Y &gt; 0 &amp; X &gt;= Y &amp; (X == X | X == Y) &amp; X &lt;= X &amp; Y &lt;= X</code></li>
</ul>
<p>These facts are very similar to those we have seen when looking at programs as facts.
The only differences are:</p>
<ul>
<li>We use symbolic values <code>X</code>, <code>Y</code>, and <code>Res</code></li>
<li><code>Res</code> has been replaced by <code>Y</code> and <code>X</code>, respectively</li>
</ul>
<p>In the second branch we can distinguish <code>X == Y</code> and <code>X &gt; Y</code> as before.</p>
<p>Into the three remaining cases we can insert the boundary values we have determined before.</p>
<ul>
<li>Test Case 1
input: <code>x == X, y == Y</code>, output: <code>Res == Y, X &gt; 0 &amp; Y &gt; 0 &amp; X &lt; Y &amp; (Y == X | Y == Y) &amp; X &lt;= Y &amp; Y &lt;= Y</code></li>
<li>Test Case 2
input: <code>x == X, y == Y</code>, output: <code>Res == X, X == Y, X &gt; 0 &amp; Y &gt; 0 &amp; X &gt;= Y &amp; (X == X | X == Y) &amp; X &lt;= X &amp; Y &lt;= X</code></li>
<li>Test Case 3
input: <code>x == X, y == Y</code>, output: <code>Res == X, X &gt; Y, X &gt; 0 &amp; Y &gt; 0 &amp; X &gt;= Y &amp; (X == X | X == Y) &amp; X &lt;= X &amp; Y &lt;= X</code></li>
</ul>
<h4 id="exercise-2">Exercise 2</h4>
<p>Formally determine the test cases for the function below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">z</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">max</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Modifies</span><span class="o">(</span><span class="n">z</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="n">z</span> <span class="o">==</span> <span class="n">x</span> <span class="o">|</span> <span class="n">z</span> <span class="o">==</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="o">,</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="k">=</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Remember that this function has a side-effect.</p>
<h3 id="testing-for-faults">Testing for Faults</h3>
<h4 id="test-cases-for-faults-in-implementations">Test Cases for Faults in Implementations</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">x</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="k">var</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">tsq</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Modifies</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="k">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="n">y</span> <span class="k">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="k">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="k">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Is the function above correct? No. Can we determine a test case confirming this?
<img src="../images/Invalid_Post-condition.png" alt="Invalid_Post-condition"></p>
<h4 id="counterexamples-from-implementations">Counterexamples from Implementations</h4>
<p>We seek a counterexample showing that the post-condition does <strong>not</strong> hold.
More formally, this is expressed,
<code>pre-condition &amp;</code>
<strong>body<sub>fact</sub> &amp;</strong> (<code>body</code> does not contain a return statement!)
<code>!post-condition</code>
For function <code>tsq</code> we get:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">*</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">&amp;</span>                <span class="c1">// First assignment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">&amp;</span>                <span class="c1">// Second assignment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">&amp;</span>       <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">y</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">)</span> <span class="o">&amp;</span>
</span></span><span class="line"><span class="cl"><span class="o">!(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">y</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">&amp;</span>      <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">!(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">-</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">|</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>                                  <span class="c1">// Negated post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s focus on the failing post-condition <code>y &gt;= 0</code>, considering branch 1.</p>
<h4 id="test-cases-for-faults-in-implementations-1">Test Cases for Faults in Implementations</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">*</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">&amp;</span>                <span class="c1">// First assignment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">&amp;</span>                <span class="c1">// Second assignment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">&amp;</span>                          <span class="c1">// Condition to enter branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">&amp;</span>       <span class="c1">// Branch 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">y</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">)</span> <span class="o">&amp;</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span>                                            <span class="c1">// Negated failing post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>This is unsatisfiable. We have:</p>
<ul>
<li><code>At(x, 1) &gt;= 0</code> and <code>At(y, 1) &gt; At(x, 1)</code></li>
<li>Therefor, <code>At(y, 1) - At(x, 1) &gt; 0</code></li>
</ul>
<p>Let&rsquo;s have a look at branch 2.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">*</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">&amp;</span>                <span class="c1">// First assignment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">0</span><span class="o">)</span> <span class="o">&amp;</span>                <span class="c1">// Second assignment
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">!(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">&amp;</span>                         <span class="c1">// Condition to enter branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">!(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">y</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">&amp;</span>      <span class="c1">// Branch 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">!(</span><span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&lt;</span> <span class="nc">At</span><span class="o">(</span><span class="n">y</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">x</span> <span class="o">==</span> <span class="nc">At</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">-</span> <span class="n">y</span><span class="o">)</span> <span class="o">&amp;</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span>                                            <span class="c1">// Negated failing post-condition
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>We proceed as if <code>y &lt; 0</code> was a post-condition and apply the same methods as before.
We find: <code>At(x, 0) == 0, At(y, 0) == -1, y == -2</code>.
Failing test case:</p>
<ul>
<li><em>input</em>: <code>x == 0, y == 0</code></li>
<li><em>output</em>: <code>y == ?         // where ? must satisfy ? &gt;= 0</code></li>
</ul>
<h4 id="exercise-3">Exercise 3</h4>
<p>Use Symbolic execution for the calculation of the counterexample.
Correct the function.</p>
<h3 id="exercises">Exercises</h3>
<h4 id="exercise-4">Exercise 4</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="k">var</span> <span class="n">x</span> <span class="k">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="k">var</span> <span class="n">q</span> <span class="k">=</span> <span class="n">randomInt</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="n">shift</span><span class="o">(</span><span class="n">p</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">N</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nc">Contract</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Requires</span><span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">N</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Modifies</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">q</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">    <span class="nc">Ensures</span><span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">N</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="k">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">  <span class="n">q</span> <span class="k">=</span> <span class="n">q</span> <span class="o">-</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Correct and verify the function above</li>
<li>Find a counterexample first by calculation</li>
<li>Derive test cases for the function</li>
<li>What are input and output?</li>
<li>Considering the post-condition choose suitable equivalence classes and boundary values
(Consider <code>p == 0</code> and <code>y == 0</code> for the uncorrected function)</li>
<li>How many test cases do you get?</li>
<li>Add deductions that explain that your function is correct</li>
</ul>
<h4 id="exercise-5-outlook">Exercise 5 (Outlook)</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scala" data-lang="scala"><span class="line"><span class="cl"><span class="c1">// linmap yields a * x + b for any a, x, and b
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">def</span> <span class="n">linmap</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// given (x - b) % a == 0 revmap yields (x - b) / a for any a, x, and b
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">def</span> <span class="n">revmap</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// compose yields x for any a, x, and b
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">def</span> <span class="n">compose</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">x</span><span class="k">:</span> <span class="kt">Z</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Z</span><span class="o">)</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl">  <span class="k">var</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Z</span> <span class="o">=</span> <span class="n">linmap</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">b</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">y</span> <span class="k">=</span> <span class="o">...</span> <span class="c1">// use function revmap
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Add the contracts according to the comments preceding the functions.
Add deductions that explain that your implementation is correct.</p>
<h4 id="summary">Summary</h4>
<p>We have discussed pure and impure functions.</p>
<p>We have introduced contracts with:</p>
<ul>
<li>Pre-conditions,</li>
<li>Post-conditions, and</li>
<li>Frames</li>
</ul>
<p>We have discussed how to derive test cases from:</p>
<ul>
<li>Specifications (resp. function contracts) and</li>
<li>Implementation (resp. function bodies &ndash; and contracts)</li>
</ul>
<p>We have analysed programs that contain faults and derived test cases for those.</p>

            </div>
        </article>

        <hr />

        
<div style="display: grid; grid-template-columns: 2% 49% 49%; text-align: center;">
  <div class="submenu" style="background: transparent; text-align: left; position: relative;">
    <li class="dropdown" onmouseover="menuDisplay(this.children[1], true);" onmouseout="menuDisplay(this.children[1], false);">
      <a class="dropbtn" href=""><i class="fa-solid fa-angles-up"></i></a>
      <div class="dropdown-content" style="bottom: 100%;"><a class="post-item-inner" href="https://doc.sireum.org/volumes/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">Volumes</a><a class="post-item-inner" href="https://doc.sireum.org/volumes/logika/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">Logika</a><a class="post-item-inner" href="https://doc.sireum.org/volumes/logika/courses/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">Course Materials</a><a class="post-item-inner" href="https://doc.sireum.org/volumes/logika/courses/software-correctness/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">Logika Course: Software Correctness</a><a class="post-item-inner" href="https://doc.sireum.org/volumes/logika/courses/software-correctness/lecture-summaries/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">Lecture Summaries</a><a class="post-item-inner" href="https://doc.sireum.org/volumes/logika/courses/software-correctness/lecture-summaries/lectures-04-contracts-test/" onmouseover="menuUnderline(this, true);" onmouseout="menuUnderline(this, false);">Contracts Test</a></div>
    </li>
  </div>
  <div style="text-align: left;">
    
  </div>
  <div style="text-align: right;">
    
  </div>
</div>



        <div class="post-info">
            
            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js" integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ==" crossorigin="anonymous"></script>



<script type="text/javascript" src="https://doc.sireum.org/bundle.min.d9847dec188cb3ba71e262769d7f64069d223c3a9713999a5da5f7aca5638686e15a900ac07cc755d19861961f24145ef2d608296933e4150cae87f4911a7dbb.js" integrity="sha512-2YR97BiMs7px4mJ2nX9kBp0iPDqXE5maXaX3rKVjhobhWpAKwHzHVdGYYZYfJBRe8tYIKWkz5BUMrof0kRp9uw=="></script>


<script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/thecarnie-cycle2/2.1.6c/jquery.cycle2.min.js" integrity="sha512-ydWfQuPu+srw5hhkU8O1XGn3/Kc+GyoDBvYc8E+SyuZKphQP18ZWYKywIFzPWZwQk6dlmTY69aDg/SnFz3qPeQ==" crossorigin="anonymous"></script>
<script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/js/all.min.js" integrity="sha512-rpLlll167T5LJHwp0waJCh3ZRf7pO6IT1+LZOhAyP6phAirwchClbTZV3iqL3BMrVxIYRbzGTpli4rfxsCK6Vw==" crossorigin="anonymous"></script>
<script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.3.14/jstree.min.js" integrity="sha512-OQ2by9SrJBwcXaeYmkG2t6FVZiwpyRtFar2VvULjuq5OjVpJLwsUHuNzN9PClqEJAYsWsRPSb4TTfriZzPGiow==" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://doc.sireum.org/_pagefind/pagefind-ui.js"></script>
  <script type="text/javascript">
    window.addEventListener('DOMContentLoaded', (event) => {
      new PagefindUI({
        element: "#search",
        showEmptyFilters: true,
        mergeIndex: [
          
            { bundlePath: "https:\/\/sireum.org\/_pagefind" },
          
            { bundlePath: "https:\/\/slang.sireum.org\/_pagefind" },
          
            { bundlePath: "https:\/\/logika.sireum.org\/_pagefind" },
          
        ]
      });
    });
  </script>
<script style="text/javascript">
  window.addEventListener('load', function () {
    $('#page-tree').jstree({
      "core": {
        "themes": {
          "name": document.documentElement.getAttribute("data-theme") == "dark" ? "default-dark" : "default",
          "dots": true,
          "icons": false,
          "variant": "large"
        }
      },
      plugins: [ "ui" ],
    }).bind("select_node.jstree", function (e, data) {
      document.location.href = data.node.a_attr.href;
    }).bind("ready.jstree", function (event, data) {
      $(this).jstree("open_all");
    }).bind("open_all.jstree", function (event, data) {
      level = 0;
      data.instance.element.find('li').each(function() {
        if (level > 0 && data.instance.get_path(this).length >= level){
          data.instance.close_node(this);
        }
      });
      data.instance.element.get()[0].style.display="block";
    });
  });
</script>


    </body>
</html>
